# Лабораторная работа 3

## Про posix api

В операционных системах семейства Unix процессы часто нуждаются в обмене данными. Для этой цели существуют различные механизмы межпроцессного взаимодействия, одним из которых являются неименованные каналы (pipes).

Канал представляет собой однонаправленный канал связи между двумя процессами. Он создается с помощью системного вызова pipe(), который возвращает два файловых дескриптора: один для чтения, другой для записи.

Системный вызов fork() создает новый процесс, который является почти точной копией родительского процесса. После выполнения fork() оба процесса продолжают выполнение со следующей инструкции. В родительском процессе fork() возвращает идентификатор дочернего процесса (PID), а в дочернем процессе возвращает 0.

Для передачи данных через канал используются системные вызовы read() и write(). Эти вызовы работают с файловыми дескрипторами, которые могут представлять как обычные файлы, так и каналы, сокеты и другие объекты ввода-вывода.

## Задание 1  

Разработать программу на языке C, состоящую из двух процессов (родительского и дочернего), которые взаимодействуют через неименованный канал (pipe). Родительский процесс должен принимать команды от пользователя через стандартный ввод (stdin) и передавать их дочернему процессу через pipe. Дочерний процесс должен выполнять соответствующие команды и выводить результат в стандартный вывод (stdout).  

Программа должна создавать pipe и запускать дочерний процесс с помощью fork().  

1. Родительский процесс:  
    - В цикле считывает команды пользователя из stdin
    - Передаёт каждую команду (в виде строки) в pipe.
    - Завершает работу при получении команды "exit".

2. Дочерний процесс:
    - Закрывает записывающий конец pipe.
    - В цикле считывает команды из pipe.
    - Выполняет следующие действия в зависимости от команды:
        - "cpu"  выводит количество логических процессорных ядер в системе.
        - "mem"  выводит общий объём оперативной памяти системы.  
        - "exit" выводит сообщение "Bye" и завершает работу.
        - Любая другая команда выводит "Unknown command".

3. Используя GDB, проведите отладку программ. Продемонстрируйте работу команд break, watch, print.  

4. Используя GDB, остановите вашу программу. Исследуйте каталог в папке /proc, который ей соответствует. Определите аргументы командной строки, переменные окружения, список открытых файлов.  

5. Убедитесь в отсутвие утечек памяти с помощью valgrind.  

6. Напишите [makefile](https://www.gnu.org/software/make/manual/make.html#Simple-Makefile) для автоматической сборки программы.  

## Задание 2  

1. Сделайте [docker](https://docs.docker.com/reference/dockerfile/) контейнер для написанной вами программы, в качестве родительского рекомендуется использовать контейнер ubuntu

Чтобы запустить контейнер используйте `docker build` и `docker run`